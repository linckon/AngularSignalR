{"version":3,"sources":["Controllers/OrdersController.ts"],"names":[],"mappings":"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","file":"OrdersController.js","sourcesContent":["/// <reference path=\"../../scripts/typings/angular-ui-bootstrap/angular-ui-bootstrap.d.ts\" />\r\n/// <reference path=\"../../scripts/typings/angularjs-toaster/angularjs-toaster.d.ts\" />\r\n/// <reference path=\"../../scripts/typings/angularjs/angular-resource.d.ts\" />\r\n\r\nmodule AngularSignalRApp.Controllers {\r\n\r\n    import ngr = ng.resource;\r\n    import constant = AngularSignalRApp.Commons.Constants;\r\n\r\n    export class OrdersController {\r\n        orders: ngr.IResourceArray<ngr.IResource<AngularSignalRApp.Models.IOrder>>;\r\n        order: AngularSignalRApp.Models.IOrder;\r\n        title: string;\r\n        toaster: ngtoaster.IToasterService;\r\n\r\n        private filter: ng.IFilterService;\r\n        private modalService: ng.ui.bootstrap.IModalService;\r\n        private ordersService: AngularSignalRApp.Services.OrdersService;\r\n        private notificationsService: AngularSignalRApp.Services.NotificationsService;\r\n        private constant: AngularSignalRApp.Commons.Constants;\r\n\r\n        constructor($filter: ng.IFilterService, $uibModal: ng.ui.bootstrap.IModalService, toaster: ngtoaster.IToasterService,\r\n            OrdersService: AngularSignalRApp.Services.OrdersService, NotificationsService: AngularSignalRApp.Services.NotificationsService) {\r\n            this.filter = $filter;\r\n            this.modalService = $uibModal;\r\n            this.ordersService = OrdersService;\r\n            this.notificationsService = NotificationsService;\r\n            this.constant = constant;\r\n\r\n            this.notificationsService.OnOrderChanges(() => {\r\n                this.Load();\r\n            });\r\n\r\n            this.toaster = toaster;\r\n            this.title = \"Orders\";\r\n\r\n            this.Load();\r\n        }\r\n\r\n        public New() {\r\n            this.order = {\r\n                Id: constant.GuidEmpty,\r\n                Article: \"\",\r\n                Amount: 0,\r\n                CreationDate: new Date(),\r\n                Customer: \"\",\r\n                Notes: \"\"\r\n            };\r\n        }\r\n\r\n        public Edit(order: AngularSignalRApp.Models.IOrder) {\r\n            this.order = order;\r\n        }\r\n\r\n        public Delete() {\r\n\r\n            var vm = this;\r\n            var modalInstance = vm.modalService.open({\r\n                animation: true,\r\n                templateUrl: \"/App/Views/Shared/ConfirmDeleteModal.html\",\r\n                controller: \"ModalsController as vm\",\r\n                size: \"modal-sm\"\r\n            });\r\n\r\n            modalInstance.result.then(function () {\r\n                vm.ordersService.delete(vm.order).$promise.then((data) => {\r\n                    var orderToDelete = vm.filter('filter')(vm.orders, { Id: vm.order.Id })[0];\r\n                    var index = vm.orders.indexOf(orderToDelete);\r\n                    vm.orders.splice(index, 1);\r\n                    vm.order = null;\r\n\r\n                    vm.notificationsService.NotifyOrderChanges();\r\n                    vm.toaster.success(\"Order deleted successfully.\");\r\n                }, (error) => {\r\n                    vm.toaster.error(\"Error deleting order.\", error.data.message);\r\n                });\r\n            });\r\n        }\r\n\r\n        public Save() {\r\n            this.ordersService.save(this.order).$promise.then((data: any) => {\r\n                if (this.order.Id == constant.GuidEmpty) {\r\n                    this.order = data;\r\n                    this.orders.push(data);\r\n                }\r\n\r\n                this.notificationsService.NotifyOrderChanges();\r\n                this.toaster.success(\"Order saved successfully.\");\r\n\r\n            }, (error: any) => {\r\n                this.toaster.error(\"Error saving order\", error.data.message);\r\n            });\r\n        }\r\n\r\n        public Close() {\r\n            this.order = null;\r\n        }\r\n\r\n        private Load() {\r\n            this.ordersService.getAll().$promise.then((data) => {\r\n                this.orders = data;\r\n                this.toaster.success(\"Orders loaded successfully.\");\r\n                return;\r\n            }, (error) => {\r\n                this.toaster.error(\"Error loading orders\", error.data.message);\r\n            });\r\n        }\r\n    }\r\n\r\n    AngularSignalR.module.controller('OrdersController', OrdersController);\r\n}\r\n"]}